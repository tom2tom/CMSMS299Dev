!function(){"use strict";function e(e,i,t){var n,l,o;n=window.innerHeight<650?Math.max(.8*window.innerHeight,250):600,l=window.innerWidth<950?Math.max(.8*window.innerWidth,250):900;var c="i"+(new Date).getTime().toString(16);tinymce.activeEditor.dom.setAttrib(tinymce.activeEditor.dom.select("html"),"data-cmsfp-instance",c),top.document.CMSFileBrowser||(top.document.CMSFileBrowser={}),top.document.CMSFileBrowser.onselect=function(i,n){function l(e){var i=e.lastIndexOf("/")+1,t=e.substring(i);return-1!==(i=t.lastIndexOf("."))&&(t=t.substring(0,i)),t}n=cms_data.root_url+"/"+n;var c={};"file"===t.filetype?c.text=l(n):"image"===t.filetype&&(c.alt=l(n)),e(n,c),top.document.CMSFileBrowser.onselect=null,o.close()};var r=cmsms_tiny.filepicker_url+"&inst="+c+"&type="+t.filetype;o=tinymce.activeEditor.windowManager.open({title:cmsms_tiny.filepicker_title,file:r,classes:"filepicker",height:n,width:l,inline:1,resizable:!0,maximizable:!0},{onFileSelected:function(e){console.debug("woot got callback with "+e)}})}tinymce.util.Tools.resolve("tinymce.PluginManager").add("cmsms_filepicker",function(i,t){i.settings.file_picker_type="file image media",i.settings.file_picker_callback=e})}();
