/*!
jQuery plug-in SSsort table-sorter/pager V.0.7
(C) 2014-2022 Tom Phane
License: GNU Affero GPL V.3 or later
  bundled with
Metadata plugin for jQuery
(C) 2006 John Resig, Yehuda Katz, JÃ¶rn Zaefferer, Paul McLanahan
Dual licensed: MIT and GPL
*/
!function($){$.fn.metadata=function(t){function e(t,e){var a={},s=t.ldelim+"(.+?):(.+?)"+t.rdelim,r=new RegExp(s).exec(e.trim());if(r&&r[2]){var n=r[1].trim(),o=r[2].trim();if("[object Boolean]"===toString.call(o))o=!!o;else if(!isNaN(parseFloat(o))&&isFinite(o))(o=parseFloat(o))==Math.floor(o)&&(o|=0);else if(o){var l=o.length-1;"'"==o[0]&&"'"==o[l]?o=o.substring(1,l):'"'==o[0]&&'"'==o[l]&&(o=o.substring(1,l)),o.match(/true/i)?o=!0:o.match(/false/i)&&(o=!1)}else o=!1;a[n]=o}return a}var a=$.extend({},$.fn.metadata.defaults,t);a.single||(a.single="metadata");var s=this[0],r=$.data(s,a.single);if(r)return r;if(r={},"class"==a.type)r=e(a,s.className);else if("elem"==a.type){if(!s.getElementsByTagName)return;var n=s.getElementsByTagName(a.name);n.length&&(r=e(a,n[0].innerHTML))}else if(void 0!==s.getAttribute){var o=s.getAttribute(a.name);o?r=e(a,o):(o=s.getAttribute("data-"+a.name))&&(r=e(a,o))}return $.data(s,a.single,r),r},$.fn.metadata.setType=function(t,e){void 0===$.fn.metadata.defaults&&($.fn.metadata.defaults={}),$.fn.metadata.defaults.type=t,$.fn.metadata.defaults.name=e},$.fn.metadata.defaults=$.extend({type:"class",name:"metadata",single:"metadata",ldelim:"{",rdelim:"}"},$.fn.metadata.defaults||{})}(jQuery),function($){$.fn.SSsort=function(o){var c={table:null,header:null,body:null,rows:null,sortcol:null,sortdata:[],currentpage:1,pagecount:1,works:[]};return this.each(function(){var u=$.extend({},c,$.fn.SSsort.defaults,o||{});u.table=this;var d=$(this);u.header=d.children("thead"),u.body=d.children("tbody"),u.rows=u.body[0].rows,u.works=[];var f=u.header.find("tr").eq(0).children("th"),m=$.fn.metadata,g=0;if(f.each(function(){var a=$(this),s=a.hasClass("nosort");if(!s&&m&&!1===a.metadata().sss&&(s=!0),!s){var r=function(a,s){var r=!1;if($.fn.metadata){var n=$(a).metadata().sss;if(!1===n)return!1;n&&(r=function(a){var s,r=t.length,n=a.toLowerCase();for(s=e;s<r;s++)if(t[s].id.toLowerCase()===n)return t[s];for(s=0;s<e;s++)if(t[s].id.toLowerCase()===n)return t[s];return!1}(n))}if(!r){var o=a.cellIndex;r=function(a,s){var r,n,o=!1,l=s.rows,c=0;for(;!1===o&&(r=l[c]);)n=r.cells[a],((o=i(n))||"number"==typeof o)&&(o=o.trim()),""===o&&(o=!1),c++;if(!1!==o){var u,d=t.length;for(u=e;u<d;u++)if(t[u].is(o,n,s))return t[u];for(u=1;u<e;u++)if(t[u].is(o,n,s))return t[u]}return t[0]}(o,s)}return r}(this,u);r&&(u.works[g]={parser:r,dirty:!0,_map:[]},u.rows.length>1&&u.sortClass&&a.addClass(u.sortClass),a.on("click activate",l))}g++}),$.data(this,"SSsortcfg",u),null!==u.firstsort){var p=f.eq(u.firstsort-1),h=p.hasClass("nosort");!h&&m&&!1===p.metadata().sss&&(h=!0),h?u.firstsort=null:p.trigger("click")}null===u.firstsort&&u.paginate&&(a(u),r(0,u),u.countid&&$("#"+u.countid).html(u.pagecount)),u.paginate&&(u.firstid&&$("#"+u.firstid).on("click activate",function(t){return t.stopPropagation(),s(!1,!0,u),!1}),u.previd&&$("#"+u.previd).on("click activate",function(t){return t.stopPropagation(),s(!1,!1,u),!1}),u.nextid&&$("#"+u.nextid).on("click activate",function(t){return t.stopPropagation(),s(!0,!1,u),!1}),u.lastid&&$("#"+u.lastid).on("click activate",function(t){return t.stopPropagation(),s(!0,!0,u),!1}),u.selid&&$("#"+u.selid).on("change",function(t){t.stopPropagation(),n("pagesize",parseInt(this.value),u)}))}),this},$.fn.SSsort.defaults={sortClass:null,ascClass:null,descClass:null,evenClass:null,oddClass:null,evensortClass:null,oddsortClass:null,firstsort:null,sortdesc:!1,paginate:!1,pagesize:20,firstid:null,previd:null,nextid:null,lastid:null,selid:null,currentid:null,countid:null,onPaged:null,onSorted:null};var t=[{id:"text",is:function(t){return!0},format:function(t){return t?t.trim():""},type:"text"},{id:"number",is:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},format:function(t){if(t){var e=Number(t);return isNaN(e)?Number.NEGATIVE_INFINITY:e}return(t+"").length>0?0:Number.POSITIVE_INFINITY},type:"numeric"},{id:"intfor",is:function(t,e){return e.hasAttribute("data-sss")},format:function(t,e){return parseInt(e.getAttribute("data-sss"))},watch:!1,type:"numeric"},{id:"isoDate",is:function(t){return/^[12]\d{3}[\/-][01]\d[\/-]\[0-3]\d$/.test(t)},format:function(t){return Date.parse(t.replace(/-/g,"/"))},type:"numeric"}],e=t.length;function a(t){t.pagecount=t.pagesize>0?Math.ceil(t.rows.length/t.pagesize):1}function s(t,e,a){var s=t?e?a.pagecount:a.currentpage+1:e?1:a.currentpage-1;s>0&&s<=a.pagecount&&(a.currentpage=s,r((s-1)*a.pagesize,a))}function r(t,e){var a=parseInt(e.pagesize,10);e.currentid&&(e.currentpage=a<1?1:1+(t/a|0),$("#"+e.currentid).html(e.currentpage));var s=e.rows;a<1&&(a=s.length+1);var r,n,o=t+a;for(r=0,n=s.length;r<n;r++)s[r].style.display=r>=t&&r<o?"":"none";"function"==typeof e.onPaged&&e.onPaged.call(e.table,e.table,e.currentpage)}function n(t,e,s){s[t]=e,s.countid&&a(s),r("currentpage"===t&&e>0?e-1:0,s),s.countid&&$("#"+s.countid).html(s.pagecount)}function o(t){var e,a,s,r=t.works[t.sortcol],n=r.parser.format,o=t.rows,l=o.length,c=t.sortcol,u=[];for(a=0;a<l;a++)e=o[a].cells[c],u[a]=[n(i(e),e,t),a];s="text"===r.parser.type?t.sortdesc?function(t,e){return e[0].localeCompare(t[0])}:function(t,e){return t[0].localeCompare(e[0])}:t.sortdesc?function(t,e){return e[0]-t[0]}:function(t,e){return t[0]-e[0]},r._map=u.sort(s)}function l(t){t.stopPropagation();var e=$(this).closest("table"),s=$.data(e[0],"SSsortcfg");if(!(s.rows.length<2)){var n,l=this.cellIndex,i=s.header.find("tr").eq(0).children("th"),c=0;if(l>0)for(n=0;n<l;n++){var u=i[n];if(u.hasAttribute("colspan")){var d=u.getAttribute("colspan");c+=parseInt(d,10)||1}else c++}var f,m,g=null;c===s.sortcol?(f=s.sortdesc?s.descClass:s.ascClass,s.sortdesc=!s.sortdesc,m=s.sortdesc?s.descClass:s.ascClass,f&&i.eq(c).removeClass(f),m&&i.eq(c).addClass(m),$(s.table).trigger("SSort.beforesort",{column:c,direction:s.sortdesc}),s.works[c].dirty?o(s):s.works[c]._map.reverse()):(null!==s.sortcol?(g=s.sortcol,(f=s.sortdesc?s.descClass:s.ascClass)&&i.eq(g).removeClass(f),s.sortClass&&(i.eq(c).removeClass(s.sortClass),i.eq(g).addClass(s.sortClass)),s.ascClass&&i.eq(c).addClass(s.ascClass),s.sortdesc=!1):(s.sortClass&&i.eq(c).removeClass(s.sortClass),(m=s.sortdesc?s.descClass:s.ascClass)&&i.eq(c).addClass(m)),s.sortcol=c,$(s.table).trigger("SSsort.beforesort",{column:c,direction:s.sortdesc}),o(s)),setTimeout(function(){var t,e,n,o,l,i=!!s.oddClass&&new RegExp("(^|\\s+)"+s.oddClass+"(?!\\S)"),d=!!s.evenClass&&new RegExp("(^|\\s+)"+s.evenClass+"(?!\\S)"),f=!!s.oddClass&&new RegExp("(^|\\s+)"+s.oddsortClass+"(?!\\S)"),m=!!s.evenClass&&new RegExp("(^|\\s+)"+s.evensortClass+"(?!\\S)"),p=s.body[0],h=p.parentNode,v=p.nextSibling,C=s.rows,N=C.length,b=s.works[c]._map;for(h.removeChild(p),n=0;n<N;n++)for(t=C[o=b[n][1]],u=t.cells[c],p.appendChild(t),n%2?(i&&(t.className=t.className.replace(i,"")),d&&!t.className.match(d)&&(t.className=t.className+" "+s.evenClass),f&&(u.className=u.className.replace(f,"")),m&&!u.className.match(m)&&(u.className=u.className+" "+s.evensortClass)):(d&&(t.className=t.className.replace(d,"")),i&&!t.className.match(i)&&(t.className=t.className+" "+s.oddClass),m&&(u.className=u.className.replace(m,"")),f&&!u.className.match(f)&&(u.className=u.className+" "+s.oddsortClass)),null!==g&&(e=t.cells[g],f&&(e.className=e.className.replace(f,"")),m&&(e.className=e.className.replace(m,""))),b[n][1]=n,l=n+1;l<N;l++)b[l][1]>o&&b[l][1]--;h.insertBefore(p,v),s.body=$(s.table).children("tbody"),s.rows=p.rows,s.works[c].dirty=void 0!==s.works[c].parser.watch&&s.works[c].parser.watch,s.paginate&&(s.currentpage=1,a(s),r(0,s),s.countid&&$("#"+s.countid).html(s.pagecount)),$(s.table).trigger("SSsort.aftersort",{column:c,direction:s.sortdesc}),"function"==typeof s.onSorted&&s.onSorted.call(s.table,s.table)},20)}}function i(t){for(;t.hasChildNodes();)t=t.firstChild;var e=t.nodeValue;return"#text"===t.nodeName&&""===e.trim()&&null!==(t=t.nextElementSibling)&&(e=t.nodeValue),e||!1}$.fn.SSsort.movePage=function(t,e,a){var r=$.data(t,"SSsortcfg");r&&s(e,a,r)},$.fn.SSsort.setCurrent=function(t,e,a){var s=$.data(t,"SSsortcfg");s&&n(e,a,s)},$.fn.SSsort.mapTable=function(t){var e={},a=1;return $(t).find("tr").each(function(){var t=this.getAttribute("id")||this.getAttribute("name")||"row"+a,s={},r=1;$(this).each(function(){var t=[];$(this).children().each(function(){t[t.length]=this.hasAttribute("value")?this.getAttribute("value"):$(this).text()});var e=this.getAttribute("id")||this.getAttribute("name")||"col"+r;switch(t.length){case 0:s[e]="<empty>";break;case 1:s[e]=t[0];break;default:var a,n,o={};for(a=0,n=t.length;a<n;a++)o[a]=t[a];s[e]=o}r++}),e[t]=s,a++}),e},$.fn.SSsort.addParser=function(e,a){var s,r=t.length,n=e.id.toLowerCase();for(s=0;s<r;s++)if(t[s].id.toLowerCase()===n)return void(a&&(t[s]=e));t[r]=e},$.fn.SSsort.formatFloat=function(t){var e=parseFloat(t);return isNaN(e)?Number.NEGATIVE_INFINITY:e},$.fn.SSsort.formatInt=function(t){var e=parseInt(t,10);return isNaN(e)?Number.NEGATIVE_INFINITY:e}}(jQuery);