!function(e,$){"use strict";var n=e.OE={};$(function(){n.helper.init(),n.view.init()}),n.helper={init:function(){$("a[rel=external]").attr("target","_blank"),$("input.defaultfocus:eq(0), input[autofocus]").focus(),this._isLocalStorage()||this.loadScript("themes/OneEleven/includes/jquery.cookie.min.js")},loadScript:function(e,n,a){var t=!0,i=null;$.isFunction(n)?(i=n,t=a||t):(t=n||t,i=a||i),$('script[type="text/javascript"]').each(function(){return e!==$(this).attr("src")}),$.ajax({type:"GET",url:e,async:!1,success:i,dataType:"script",cache:t})},setStorageValue:function(e,n,a){var t=(new Date).getTime()+24*a*60*60*1e3,i={};try{!0===this._isLocalStorage()?(localStorage.removeItem(e),i=null!==a?{value:n,timestamp:t}:{value:n,timestamp:""},localStorage.setItem(e,JSON.stringify(i))):(null!==a&&(i={expires:a}),"undefined"!==$.fn.cookie&&$.cookie(e,n,i))}catch(a){console.log("localStorage Error: set("+e+", "+n+")"),console.log(a)}},getStorageValue:function(e){var n,a="";return this._isLocalStorage()?null!==(a=JSON.parse(localStorage.getItem(e)))&&a.timestamp<(new Date).getTime()?this.removeStorageValue(e):null!==a&&(n=a.value):"undefined"!==$.fn.cookie&&(n=$.cookie(e)),n},removeStorageValue:function(e){this._isLocalStorage()?localStorage.removeItem(e):$.cookie(e,null)},equalHeight:function(e){var n=0;e.each(function(){var e=$(this).height();e>n&&(n=e)}),e.height(n)},_isLocalStorage:function(){return"undefined"!=typeof Storage},_isMobileDevice:function(){if(navigator.userAgent.toLowerCase().match(/(Android|iPhone|iPad|iPod|Blackberry|Dolphin|IEMobile|WPhone|Windows Mobile|IEMobile9||IEMobile10||IEMobile11|Kindle|Mobile|MMP|MIDP|Pocket|PSP|Symbian|Smartphone|Sreo|Up.Browser|Up.Link|Vodafone|WAP|Opera Mini|Opera Tablet|Mobile|Fennec)/i)&&("ontouchstart"in window||navigator.msMaxTouchPoints>0||window.DocumentTouch&&document instanceof DocumentTouch))return!0}},n.view={init:function(){var e=this,n=$(".toggle-button"),a=$("#oe_container"),t=$("#oe_pagemenu");n.on("click",function(n){n.preventDefault(),a.hasClass("sidebar-on")?e._closeSidebar(a,t):e._showSidebar(a,t)}),e.toggleSubMenu(t,50),e.showNotifications(),e.setupAlerts(),e.updateDisplay(),e.handleSidebar(a),$(window).resize(function(){e.handleSidebar(a),e.updateDisplay()})},handleSidebar:function(e){var a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;"sidebar-off"===n.helper.getStorageValue("sidebar-pref")||a<=992?e.addClass("sidebar-off").removeClass("sidebar-on"):e.addClass("sidebar-on").removeClass("sidebar-off")},toggleSubMenu:function(e,n){var a=this;e.find("li.current span").addClass("open-sub"),e.find("> li > span").on("click",function(){var t=$(this).next(),i=[];!1===t.is(":visible")&&i.push(e.find("ul").slideUp(n)),i.push(t.slideToggle(n)),$.when.apply($,i).done(function(){a.updateDisplay()})})},showNotifications:function(){$(".pagewarning, .message, .pageerrorcontainer, .pagemcontainer").prepend('<span class="close-warning"></span>'),$(document).on("click",".close-warning",function(){$(this).parent().hide(),$(this).parent().remove()});var e=$("body").attr("id")+"_notification";$(".pagewarning .close-warning").on("click",function(){n.helper.setStorageValue(e,"hidden",60)}),"hidden"===n.helper.getStorageValue(e)&&$(".pagewarning").addClass("hidden"),$(".message:not(.no-slide)").on("click",function(){$(".message").slideUp()}),$(".message:not(.no-slide), .pageerrorcontainer:not(.no-slide), .pagemcontainer:not(.no-slide)").each(function(){var e=$(this);$(e).hide().slideDown(1e3,function(){window.setTimeout(function(){e.slideUp()},1e4)})}),$(document).on("cms_ajax_apply",function(e){$("button[name=cancel], button[name=m1_cancel]").fadeOut(),$("button[name=cancel], button[name=m1_cancel]").button("option","label",e.close),$("button[name=cancel], button[name=m1_cancel]").fadeIn();var n="";"Success"===e.response?n='<aside class="message pagemcontainer" role="status"><span class="close-warning">Close</span><p class="pagemessage">'+e.details+"</p></aside>":(n='<aside class="message pageerrorcontainer" role="alert"><span class="close-warning">Close</span><ul class="pageerror">',n+=e.details,n+="</ul></aside>"),$("body").append(n).slideDown(1e3,function(){window.setTimeout(function(){$(".message").slideUp(),$(".message").remove()},1e4)}),$(document).on("click",".close-warning",function(){$(".message").slideUp(),$(".message").remove()})})},setUIButtons:function(){$('input[type="submit"], :button[data-ui-icon]').each(function(){var e=$(this),n=e.data("uiIcon")||"ui-icon-circle-check",a=e.val(),t=$("<button />");e.hasClass("noautobtn")&&e.hasClass("no-ui-btn")||(e.is("[name*=apply]")?n=e.data("uiIcon")||"ui-icon-disk":e.is("[name*=cancel]")?n=e.data("uiIcon")||"ui-icon-circle-close":(e.is("[name*=resettodefault]")||"refresh"===e.attr("id"))&&(n=e.data("uiIcon")||"ui-icon-refresh")),e.is(":button")&&(a=e.text()),$(this.attributes).each(function(e,n){t.attr(n.name,n.value)}),t.button({icons:{primary:n},label:a}),e.replaceWith(t)}),$("a.pageback").addClass("ui-state-default ui-corner-all").prepend('<span class="ui-icon ui-icon-arrowreturnthick-1-w">').hover(function(){$(this).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover")})},updateDisplay:function(){},_showSidebar:function(e,a){e.addClass("sidebar-on").removeClass("sidebar-off"),a.find("li.current ul").show(),n.helper.setStorageValue("sidebar-pref","sidebar-on",60)},_closeSidebar:function(e,a){e.removeClass("sidebar-on").addClass("sidebar-off"),a.find("li ul").hide(),n.helper.setStorageValue("sidebar-pref","sidebar-off",60)},_handleAlert:function(e){var n=$(e).closest(".alert-box"),a=n.data("alert-name");if(a)return $.ajax({method:"POST",url:cms_data.ajax_alerts_url,data:{op:"delete",alert:a}}).done(function(){n.slideUp(1e3),n.parent().children().length<=1&&(n.closest("div.ui-dialog-content").dialog("close"),$("#alert-noalerts").show(),$("a#alerts").closest("li").remove()),n.remove()}).fail(function(e,n,a){console.debug("problem deleting an alert: "+a)})},setupAlerts:function(){var e=this;$("a#alerts").on("click",function(e){e.preventDefault(),$("#alert-dialog").dialog()}),$(".alert-msg a").on("click",function(e){e.preventDefault(),n.view.handleAlert(e.target)}),$(".alert-icon,.alert-remove").on("click",function(n){n.preventDefault(),e._handleAlert(n.target)})}}}(this,jQuery);
